### 1. 计算机的硬件组成

  * **冯诺依曼架构** ：
    
    ![image-20250423214120258](C:\Users\leglon\AppData\Roaming\Typora\typora-user-images\image-20250423214120258.png)

    
    
    * **存储程序原理** ：程序指令和数据统一存储在内存中，CPU 按照存储地址顺序依次取出指令并执行，这使得计算机能够自动运行程序。
    * **总线结构** ：使用一根总线进行数据传输，控制逻辑相对简单，硬件成本较低。但由于总线带宽有限，当 CPU 与内存或其他设备进行数据交换时，可能会出现总线竞争等问题，影响执行效率。
    
  * **CPU（中央处理单元）** ：
    * **控制单元（CU）** ：负责从内存中取出指令、分析指令的操作码和地址码，并产生相应的控制信号，协调 CPU 内部各部件的工作，确保指令能够正确执行。
    * **算术逻辑单元（ALU）** ：执行算术运算（如加、减、乘、除）和逻辑运算（如与、或、非、异或）等操作，是计算机进行数据处理的核心部件。
    * **寄存器（Register）** ：用于暂时存储参与运算的数据、运算的中间结果或最终结果等信息，寄存器的访问速度比内存快得多，能够提高 CPU 的运算效率。

  * **I/O 桥** ：连接 CPU 和外部设备，主要负责数据的传输和转换，实现 CPU 与外设之间的通信，如通过各种接口（如 USB、HDMI 等）与键盘、鼠标、显示器、打印机等外设相连。

  * **哈佛架构** ：
    * **独立存储空间** ：程序指令和数据分别存储在独立的存储空间中，拥有各自的总线进行数据传输，这使得指令和数据可以同时被访问，提高了执行效率。
    
    * **应用场景** ：在一些嵌入式系统中应用较为广泛，如数字信号处理器（DSP）等，因为嵌入式系统通常对实时性和效率要求较高。
    
      ![image-20250423214140104](C:\Users\leglon\AppData\Roaming\Typora\typora-user-images\image-20250423214140104.png)
    
      

### 2. 程序的存储与运行

  * **程序的存储** ：
    * **编译和链接** ：编译器将高级语言编写的源代码转换为汇编语言或机器语言的目标文件，链接器将多个目标文件进行合并，生成最终可执行的程序文件（如 a.out）。在这个过程中，会进行地址分配、符号解析等工作，确保程序中的各个模块能够正确地相互引用。
    * **内存布局** ：程序在内存中的布局通常包括代码段（存储指令）、数据段（存储全局变量和静态变量）、堆（动态分配的内存）、栈（存储局部变量和函数调用信息）等部分。

  * **程序的运行** ：
    * **控制单元的工作流程** ：取指阶段，CPU 从内存中取出指令到指令寄存器；译码阶段，分析指令的操作码和操作数，确定要执行的操作；执行阶段，CU 控制 ALU 进行相应的运算或数据传输等操作。
    * **晶振的作用** ：为 CPU 提供时钟信号，时钟信号就像 CPU 的心跳，控制着 CPU 内部各部件的操作节奏，确保各个操作有序、同步地进行。CPU 的时钟频率越高，理论上处理速度越快。

### 3. 程序语言的设计和进化

  * **以 mini 计算机为例** ：
    
    ![image-20250423214158682](C:\Users\leglon\AppData\Roaming\Typora\typora-user-images\image-20250423214158682.png)

    
    
    * **计算机的基本结构** ：假设一个简单的 8 位计算机，只有两个寄存器，主要支持加法计算功能。
    * **C 语言到机器语言的映射** ：对于 C 语言中的 a+b 操作，在机器语言层面需要通过一系列指令来实现，包括将数据从内存加载到寄存器、执行加法运算、将结果存储回内存等步骤。对于 a = b + c 的具体操作过程，首先要把 b 和 c 的数据从内存搬到 CPU 寄存器里，然后通过加法指令在 ALU 中进行运算，得到结果后再将结果从寄存器放到内存中 a 所在的地址。
    
  * **针对 mini 计算机的机器指令设计** ：
    * **基本指令类型** ：load 指令用于将数据从内存加载到寄存器；add 指令用于执行加法运算；store 指令用于将寄存器中的数据存储回内存。这些指令构成了计算机指令集的基础，用于完成各种数据处理和运算任务。
    
    * **指令编码格式** ：从低位到高位设计 2 位操作码（用于标识指令类型，如 load、add 等）、2 位寄存器码（指定参与操作的寄存器编号）、4 位地址码（指示内存地址或数据偏移量）。PC（程序计数器）初始指向第一条指令的地址，随着程序的执行依次指向后续指令的地址，从而控制程序的执行流程。
    
      ![image-20250423214214997](C:\Users\leglon\AppData\Roaming\Typora\typora-user-images\image-20250423214214997.png)
    
      
    
  * **编程语言的进化** ：
    * **机器语言** ：直接使用二进制代码表示的指令，计算机能够直接识别和执行，但可读性和可移植性差，编写和维护困难。
    * **汇编语言** ：使用助记符来表示机器指令，通过汇编器转换为机器语言。与机器语言相比，可读性有所提高，但仍然依赖于具体的计算机硬件架构，不同架构的汇编语言有所不同。
    * **高级语言** ：如 C、C++、Java 等，具有较高的抽象层次，独立于具体的计算机硬件，更接近人类的自然语言和数学表达式。通过编译器或解释器将高级语言编写的程序转换为机器语言，能够大大提高开发效率和程序的可维护性。

### 4. 存储设备的层次结构

![image-20250423214423261](C:\Users\leglon\AppData\Roaming\Typora\typora-user-images\image-20250423214423261.png)



  * **存储设备分类** ：
    * **高速缓存（Cache）** ：位于 CPU 和主内存之间，容量较小但访问速度极快，用于暂存 CPU 近期常用的指令和数据，以减少 CPU 访问内存的等待时间，提高系统的整体性能。
    * **主存储器（内存）** ：用于存放当前正在运行的程序和数据，能够被 CPU 直接访问。内存的读写速度快，但掉电后数据会丢失。
    * **辅助存储器（外存）** ：如硬盘、固态盘、光盘等，具有大容量、非易失性的特点，用于长期存储大量的程序和数据。外存中的数据需要先调入内存后才能被 CPU 处理。

  * **存储层次结构的意义** ：通过构建多级存储层次结构，在成本、容量、速度和可靠性等方面取得平衡，既能够满足计算机系统对存储设备的高性能要求，又能够降低成本，同时保证数据的安全存储和快速访问。

### 5. 操作系统

  * **操作系统的功能** ：
    * **硬件保护** ：防止硬件被失控的软件应用程序滥用，确保系统的稳定运行。例如，限制程序对硬件资源的直接访问，通过操作系统内核进行统一管理和调度。
    * **提供抽象接口** ：向应用程序提供简单一致的抽象接口来控制复杂的多种外设硬件，使得应用程序开发者无需关心硬件的具体细节，方便程序的编写和移植。例如，文件系统的抽象接口允许程序以文件的形式访问磁盘上的数据，而无需直接操作磁盘扇区等物理存储单元。

  * **小组三人构建 RISC-V 架构操作系统内核** ：
    * **RISC-V 架构特点** ：RISC-V 是一种开源的指令集架构，具有简洁、模块化、可扩展等特点，适合用于构建各种嵌入式系统和通用计算机系统。它的指令集相对精简，易于实现和优化，为操作系统内核的开发提供了良好的硬件基础。
    * **操作系统内核的构建要点** ：
      * **内核结构设计** ：确定采用何种内核结构，如单内核、微内核、混合内核等。不同内核结构在性能、可靠性、可扩展性等方面各有优缺点，需根据具体需求进行权衡和选择。
      * **内存管理系统** ：实现对内存的分配、回收、映射等操作，包括虚拟内存管理、物理内存分配算法、内存保护机制等，确保多个进程能够安全、高效地共享有限的内存资源。
      * **进程调度与管理** ：设计进程调度算法，决定 CPU 的分配策略，如何在多个进程之间进行切换，以及如何处理进程的创建、销毁、等待、唤醒等操作，以实现多任务处理和提高系统的并发性能。
      * **文件系统实现** ：构建文件系统的结构和操作接口，管理磁盘上的文件存储和读写操作，提供文件的创建、删除、打开、关闭、读写等功能，支持文件的组织、存储和共享。
      * **设备驱动开发** ：为各类外设（如键盘、鼠标、显示器、网卡等）开发相应的驱动程序，使操作系统能够与外设进行通信和控制，实现对外设的初始化、配置、数据传输等操作。

通过深入理解和掌握上述计算机系统的相关知识点，并结合 RISC-V 架构的特点，小组成员逐步开展操作系统内核的开发工作，实现一个功能完善、性能可靠的 RISC-V 操作系统内核。在开发过程中，我们需要不断地进行代码调试、测试和优化，以确保系统的稳定性和可靠性。